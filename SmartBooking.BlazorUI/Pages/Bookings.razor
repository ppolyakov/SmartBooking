@page "/bookings"
@inject IBookingService BookingService
@inject ISnackbar Snackbar

<MudPaper Class="p-4">
    <MudText Typo="Typo.h5" Class="mb-4">All Bookings</MudText>

    <MudTable Items="_bookings" Hover="true" Dense="true">
        <HeaderContent>
            <MudTh>Date & Time</MudTh>
            <MudTh>Service</MudTh>
            <MudTh>Client</MudTh>
            <MudTh>Email</MudTh>
        </HeaderContent>
        <RowTemplate>
            <MudTd>@context.StartTime.ToString("g")</MudTd>
            <MudTd>@context.ServiceTitle</MudTd>
            <MudTd>@context.ClientName</MudTd>
            <MudTd>@context.ClientEmail</MudTd>
        </RowTemplate>
    </MudTable>
</MudPaper>

@code {
    private List<BookingDto> _bookings = [];

    protected override async Task OnInitializedAsync()
    {
        var result = await BookingService.GetAllAsync();
        if (result.IsSuccess)
        {
            _bookings = result.Value;
        }
        else
        {
            Snackbar.Add($"Failed to load bookings: {result.ErrorMessage}", Severity.Error);
        }
    }
}